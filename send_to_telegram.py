
#!/usr/bin/env python3
"""
ุฅุฑุณุงู ุนูุงุฑุงุช ุชุฌุฑูุจูุฉ ุฅูู ููุงุฉ ุงูุชููุฌุฑุงู ูุงุฎุชุจุงุฑ ุงููุธุงู ุงููุญุฏุซ
"""

import asyncio
import os
from config import Config
from services.telegram_service import TelegramService
from utils.logger import setup_logger

logger = setup_logger(__name__)

# ุงูุฑุณุงุฆู ุงูุนูุงุฑูุฉ ุงููุญุฏุซุฉ ูููุงู ููุฏููู ุงูุฌุฏูุฏ
PROPERTY_MESSAGES = [
    """
๐ ุนูุงุฑ ููุฅูุฌุงุฑ - ุงูุชุฌูุน ุงูุฎุงูุณ

ุงูููุทูุฉ: ุงุญูุงุก ุชุฌูุน
ุงูููุน: ุดูุฉ ุณูููุฉ
ุงููุณุงุญุฉ: 120 ูุชุฑ ูุฑุจุน
ุงูุฏูุฑ: ุงูุซุงูุซ
ุงูุณุนุฑ: 25000 ุฌููู ุดูุฑูุงู
ุงูุญุงูุฉ: ููุฑูุด

ุงููููุฒุงุช:
- ููููู
- ููู ููุชูุญ  
- ุงุณุงูุณูุฑ
- ุญุฏููู

ููุชูุงุตู: ุฃุญูุฏ ูุญูุฏ - 01234567890
ุงููุงูู: ุณุงุฑุฉ ุฃุญูุฏ - 01111111111
ูุชููุฑ ุตูุฑ ูููุญุฏุฉ

ุงูุนููุงู: ุดุงุฑุน ุงูุชุณุนูู ุงูุดูุงููุ ุงูุชุฌูุน ุงูุฎุงูุณุ ุงููุงูุฑุฉ ุงูุฌุฏูุฏุฉ
ุชุจุน ุจูุจู
ูุชุงุญ
    """,
    """
๐ก ูููุง ุฏูุจููุณ ููุฅูุฌุงุฑ - ุงูุดุฑูู

ุงูููุทูุฉ: ุงูุฏูุณ
ุงูููุน: ูููุง ุฏูุจููุณ  
ุงููุณุงุญุฉ: 250 ูุชุฑ ูุฑุจุน
ุงูุฃุฏูุงุฑ: ุฏูุฑ ุฃุฑุถู + ุฃูู
ุงูุณุนุฑ: 45000 ุฌููู ุดูุฑูุงู
ุงูุญุงูุฉ: ูุงุถู

ุงููููุฒุงุช:
- ุญุฏููู ุฎุงุตุฉ
- ุชุดุทูุจ ุณูุจุฑ ูููุณ
- ูุฏุฎู ุฎุงุต

ููุชูุงุตู: ูุงุทูุฉ ุนูู - 01987654321
ุงููุงูู: ูุญูุฏ ุญุณู - 01222222222
ุจุฏูู ุตูุฑ ุญุงููุงู

ุงูุนููุงู: ุงูููุทูุฉ ุงูุซุงููุฉุ ุงูุฏูุณ
ุชุจุน ููุณู ุนูุงุฏ
ุบูุฑ ูุชุงุญ
    """,
    """
๐ข ุดูุฉ ุชูููู - ุฌุงุฑุฏูููุง ูุงูุชุณ

ุงูููุทูุฉ: ุฌุงุฑุฏูููุง ูุงูุชุณ
ุงูููุน: ุดูุฉ
ุงููุณุงุญุฉ: 180 ูุชุฑ
ุงูุฏูุฑ: ุฏูุฑ ุฑุงุจุน
ุงูุณุนุฑ: 1500000 ุฌููู
ุงูุญุงูุฉ: ุชูููู

ุงููููุฒุงุช:
- ูุณุฌูู ุดูุฑ ุนูุงุฑู
- ุงุณุงูุณูุฑ
- ููู ุฌุงุฑุฏู
- ุชูุณูุท

ููุชูุงุตู: ูุญููุฏ ุณุงูู - 01555666777
ุงููุงูู: ุฃููุฑุฉ ุฎุงูุฏ - 01333444555
ุจุตูุฑ ูุชุงุญุฉ

ุงูุนููุงู: ููุจููุฏ ุฌุงุฑุฏูููุง ูุงูุชุณุ ุงูุญู ุงูุฎุงูุณ
ุชุจุน ูุญููุฏ ุณุงูู
ูุชุงุญ
    """
]

async def send_properties_to_channel():
    """ุฅุฑุณุงู ุงูุนูุงุฑุงุช ุงูุชุฌุฑูุจูุฉ ุฅูู ููุงุฉ ุงูุชููุฌุฑุงู"""
    
    config = Config()
    
    # ุงุณุชุฎุฏุงู ุจูุช ุงูุฅุฑุณุงู ุงูุฌุฏูุฏ
    sender_bot_token = config.TELEGRAM_BOT_sender_TOKEN
    if not sender_bot_token:
        logger.error("โ ูู ูุชู ุงูุนุซูุฑ ุนูู TELEGRAM_BOT_sender_TOKEN")
        return False
    
    # ุงุณุชุฎุฏุงู ุงูููุงุฉ ุงูุฑุฆูุณูุฉ ูููุนุงูุฌุฉ ููุฌูุฉ ููุฅุฑุณุงู
    target_channel = config.TELEGRAM_CHANNEL_ID
    if not target_channel:
        logger.error("โ ูู ูุชู ุงูุนุซูุฑ ุนูู TELEGRAM_CHANNEL_ID")
        return False
    
    try:
        # ุฅูุดุงุก ุฎุฏูุฉ ุชููุฌุฑุงู ูุฎุตุตุฉ ููุฅุฑุณุงู
        sender_config = Config()
        sender_config.TELEGRAM_BOT_TOKEN = sender_bot_token
        sender_config.TELEGRAM_CHANNEL_ID = target_channel
        
        async with TelegramService(sender_config) as telegram_service:
            logger.info(f"๐ค ุจุฏุก ุฅุฑุณุงู ุงูุนูุงุฑุงุช ุงูุชุฌุฑูุจูุฉ ุฅูู ุงูููุงุฉ {target_channel}...")
            
            sent_messages = []
            for i, message in enumerate(PROPERTY_MESSAGES, 1):
                logger.info(f"๐ค ุฅุฑุณุงู ุงูุนูุงุฑ {i}/{len(PROPERTY_MESSAGES)} ุฅูู ุงูููุงุฉ...")
                
                # ุฅุฑุณุงู ุงูุฑุณุงูุฉ ุฅูู ุงูููุงุฉ ุงูุฑุฆูุณูุฉ ูููุนุงูุฌุฉ
                success = await telegram_service.send_message_to_channel(message)
                
                if success:
                    logger.info(f"โ ุชู ุฅุฑุณุงู ุงูุนูุงุฑ {i} ุจูุฌุงุญ ุฅูู ุงูููุงุฉ ุงูุฑุฆูุณูุฉ")
                    sent_messages.append(message)
                else:
                    logger.error(f"โ ูุดู ูู ุฅุฑุณุงู ุงูุนูุงุฑ {i}")
                
                # ุชููู ูุตูุฑ ุจูู ุงูุฑุณุงุฆู
                await asyncio.sleep(3)
        
        logger.info(f"โ ุชู ุฅุฑุณุงู {len(sent_messages)} ุนูุงุฑ ุฅูู ุงูููุงุฉ")
        
        # ุงูุชุธุงุฑ ููุนุงูุฌุฉ ุงูุฑุณุงุฆู
        logger.info("โณ ุงูุชุธุงุฑ ูุนุงูุฌุฉ ุงูุฑุณุงุฆู...")
        await asyncio.sleep(10)
        
        return True
        
    except Exception as e:
        logger.error(f"โ ุฎุทุฃ ูู ุฅุฑุณุงู ุงูุนูุงุฑุงุช: {e}")
        return False

async def main():
    """ุงูุฏุงูุฉ ุงูุฑุฆูุณูุฉ"""
    print("๐ ุฅุฑุณุงู ุงูุนูุงุฑุงุช ุงูุชุฌุฑูุจูุฉ ุฅูู ููุงุฉ ุงูุชููุฌุฑุงู")
    print("=" * 50)
    
    success = await send_properties_to_channel()
    
    if success:
        print("\nโ ุชู ุฅุฑุณุงู ุงูุนูุงุฑุงุช ุจูุฌุงุญ!")
        print("ุงูุขู ูููู ุชุดุบูู ุงููุธุงู ููุนุงูุฌุฉ ูุฐู ุงูุฑุณุงุฆู:")
        print("   python test_full_system.py  # ููุงุฎุชุจุงุฑ")
        print("   python main.py             # ููุชุดุบูู ุงููุงูู")
    else:
        print("\nโ ูุดู ูู ุฅุฑุณุงู ุงูุนูุงุฑุงุช")

if __name__ == "__main__":
    asyncio.run(main())
