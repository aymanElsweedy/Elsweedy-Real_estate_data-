#!/usr/bin/env python3
"""
ุฅุฑุณุงู ุนูุงุฑุงุช ุชุฌุฑูุจูุฉ ุฅูู ููุงุฉ ุงูุชููุฌุฑุงู ูุงุฎุชุจุงุฑ ุงููุธุงู ุงููุญุฏุซ
"""

import asyncio
import os
from config import Config
from services.telegram_service import TelegramService
from utils.logger import setup_logger

logger = setup_logger(__name__)

# ุงูุฑุณุงุฆู ุงูุนูุงุฑูุฉ ุงูุชู ุณูุชู ุฅุฑุณุงููุง
PROPERTY_MESSAGES = [
    """
๐ ุนูุงุฑ ููุฅูุฌุงุฑ - ุงูุชุฌูุน ุงูุฎุงูุณ

๐ ุงูููุทูุฉ: ุงูุชุฌูุน ุงูุฎุงูุณุ ุงููุงูุฑุฉ ุงูุฌุฏูุฏุฉ
๐ข ุงูููุน: ุดูุฉ ุณูููุฉ
๐ ุงููุณุงุญุฉ: 120 ูุชุฑ ูุฑุจุน
๐๏ธ ุงูุฏูุฑ: ุงูุซุงูุซ
๐ฐ ุงูุณุนุฑ: 25,000 ุฌููู ุดูุฑูุงู
๐๏ธ ุงูุญุงูุฉ: ููุฑูุดุฉ ุจุงููุงูู

ุงููููุฒุงุช:
โ ููููุฉ
โ ููู ููุชูุญ
โ ุงุณุงูุณูุฑ
โ ูููู ุณูุงุฑุฉ

๐ ููุชูุงุตู: ุฃุญูุฏ ูุญูุฏ - 01234567890
๐ค ุงููุงูู: ุณุงุฑุฉ ุฃุญูุฏ - 01111111111
๐ธ ูุชููุฑ ุตูุฑ ูููุญุฏุฉ

ููุฏ ุงููุญุฏุฉ: TEST-001-2024
ุงูุนููุงู: ุดุงุฑุน ุงูุชุณุนูู ุงูุดูุงููุ ุงูุชุฌูุน ุงูุฎุงูุณุ ุงููุงูุฑุฉ ุงูุฌุฏูุฏุฉ
    """,
    """
๐ก ูููุง ูููุฒุฉ ููุฅูุฌุงุฑ - ุงูุดุฑูู

๐ ุงูููุทูุฉ: ุงูููุทูุฉ ุงูุซุงููุฉุ ูุฏููุฉ ุงูุดุฑูู
๐ข ุงูููุน: ูููุง ุฏูุจูููุณ
๐ ุงููุณุงุญุฉ: 250 ูุชุฑ ูุฑุจุน
๐๏ธ ุงูุฃุฏูุงุฑ: ุฏูุฑ ุฃุฑุถู + ุฃูู
๐ฐ ุงูุณุนุฑ: 45,000 ุฌููู ุดูุฑูุงู
๐๏ธ ุงูุญุงูุฉ: ุบูุฑ ููุฑูุดุฉ

ุงููููุฒุงุช:
๐ณ ุญุฏููุฉ ุฎุงุตุฉ
๐ ุฌุฑุงุฌ ููุณูุงุฑุงุช
๐ณ ูุทุจุฎ ุฌุงูุฒ
๐ฟ 3 ุญูุงูุงุช
๐ ุบุฑู ูุงุณุนุฉ

๐ ููุชูุงุตู: ูุงุทูุฉ ุนูู - 01987654321
๐ค ุงููุงูู: ูุญูุฏ ุญุณู - 01222222222
๐ธ ูุง ุชูุฌุฏ ุตูุฑ ุญุงููุงู

ููุฏ ุงููุญุฏุฉ: TEST-002-2024
ุงูุนููุงู: ุงูููุทูุฉ ุงูุซุงููุฉุ ูุฏููุฉ ุงูุดุฑูู
    """
]

async def send_properties_to_channel():
    """ุฅุฑุณุงู ุงูุนูุงุฑุงุช ุงูุชุฌุฑูุจูุฉ ุฅูู ููุงุฉ ุงูุชููุฌุฑุงู"""
    
    config = Config()
    
    if not config.TELEGRAM_BOT_TOKEN:
        logger.error("โ ูู ูุชู ุงูุนุซูุฑ ุนูู TELEGRAM_BOT_TOKEN")
        return False
    
    if not config.TELEGRAM_CHANNEL_ID:
        logger.error("โ ูู ูุชู ุงูุนุซูุฑ ุนูู TELEGRAM_CHANNEL_ID")
        return False
    
    try:
        async with TelegramService(config) as telegram_service:
        
        logger.info("๐ค ุจุฏุก ุฅุฑุณุงู ุงูุนูุงุฑุงุช ุงูุชุฌุฑูุจูุฉ ุฅูู ุงูููุงุฉ...")
            
            sent_messages = []
            for i, message in enumerate(PROPERTY_MESSAGES, 1):
                logger.info(f"๐ค ุฅุฑุณุงู ุงูุนูุงุฑ {i} ุฅูู ุงูููุงุฉ...")
                
                # ุฅุฑุณุงู ุงูุฑุณุงูุฉ ุฅูู ุงูููุงุฉ
                success = await telegram_service.send_message_to_channel(message)
                
                if success:
                    logger.info(f"โ ุชู ุฅุฑุณุงู ุงูุนูุงุฑ {i} ุจูุฌุงุญ")
                    sent_messages.append(message)
                else:
                    logger.error(f"โ ูุดู ูู ุฅุฑุณุงู ุงูุนูุงุฑ {i}")
                
                # ุชููู ูุตูุฑ ุจูู ุงูุฑุณุงุฆู
                await asyncio.sleep(3)
        
        logger.info(f"โ ุชู ุฅุฑุณุงู {len(sent_messages)} ุนูุงุฑ ุฅูู ุงูููุงุฉ")
        
        # ุงูุชุธุงุฑ ููุนุงูุฌุฉ ุงูุฑุณุงุฆู
        logger.info("โณ ุงูุชุธุงุฑ ูุนุงูุฌุฉ ุงูุฑุณุงุฆู...")
        await asyncio.sleep(10)
        
        # ูุญุต ุงูุฑุณุงุฆู ุงููุณุชููุฉ
        logger.info("๐ ูุญุต ุงูุฑุณุงุฆู ุงููุณุชููุฉ ูู ุงูููุงุฉ...")
        received_messages = await telegram_service.get_channel_messages()
        
        if received_messages:
            logger.info(f"๐ฅ ุชู ุงุณุชูุงู {len(received_messages)} ุฑุณุงูุฉ ูู ุงูููุงุฉ")
            for i, msg in enumerate(received_messages[-2:], 1):  # ุขุฎุฑ ุฑุณุงูุชูู
                logger.info(f"๐ฉ ุงูุฑุณุงูุฉ {i}: ูุนุฑู {msg.get('message_id', 'ุบูุฑ ูุนุฑูู')}")
        else:
            logger.warning("โ๏ธ ูู ูุชู ุงุณุชูุงู ุฃู ุฑุณุงุฆู ูู ุงูููุงุฉ")
        
        return True
        
    except Exception as e:
        logger.error(f"โ ุฎุทุฃ ูู ุฅุฑุณุงู ุงูุนูุงุฑุงุช: {e}")
        return False

async def main():
    """ุงูุฏุงูุฉ ุงูุฑุฆูุณูุฉ"""
    print("๐ ุฅุฑุณุงู ุงูุนูุงุฑูู ุฅูู ููุงุฉ ุงูุชููุฌุฑุงู")
    print("=" * 50)
    
    success = await send_properties_to_channel()
    
    if success:
        print("\nโ ุชู ุฅุฑุณุงู ุงูุนูุงุฑุงุช ุจูุฌุงุญ!")
        print("ุงูุขู ูููู ูููุธุงู ูุญุต ูุฐู ุงูุฑุณุงุฆู ููุนุงูุฌุชูุง ุชููุงุฆูุงู")
    else:
        print("\nโ ูุดู ูู ุฅุฑุณุงู ุงูุนูุงุฑุงุช")

if __name__ == "__main__":
    asyncio.run(main())