
#!/usr/bin/env python3
"""
ูุญุงูู ุจูุช ุงูุฅุฑุณุงู - ูุญุงูู ุนูู @RealEstate_Sender_bot
ูุณุชูุจู ุฑุณุงุฆู ูู ุงูุฒููุงุก ููุญูููุง ููููุงุฉ ุงูุฑุฆูุณูุฉ
"""

import asyncio
import aiohttp
from utils.logger import setup_logger

logger = setup_logger(__name__)

# ุฅุนุฏุงุฏุงุช ุงูุจูุช ุงูููุฑุณูู
SENDER_BOT_TOKEN = "7613162592:AAFnqn3_1lPPClVUa1jckOXj44C2MGCVLHs"
MAIN_CHANNEL_ID = "-1002394758962"  # ุงูููุงุฉ ุงูุฑุฆูุณูุฉ ูููุนุงูุฌุฉ

# ุฑุณุงุฆู ุชุฌุฑูุจูุฉ ูู ุงูุฒููุงุก
EMPLOYEE_MESSAGES = [
    """
    ูู: ุฃุญูุฏ (ููุธู ุงููุจูุนุงุช)
    
    ๐ ุนูุงุฑ ุฌุฏูุฏ ููุฅูุฌุงุฑ
    ุงูููุทูุฉ: ุงูุชุฌูุน ุงูุฎุงูุณ - ุงุญูุงุก ุชุฌูุน
    ุงูููุน: ุดูุฉ ุณูููุฉ ููุฑูุดุฉ
    ุงููุณุงุญุฉ: 120 ูุชุฑ
    ุงูุฏูุฑ: ุงูุซุงูุซ
    ุงูุณุนุฑ: 25000 ุฌููู ุดูุฑูุงู
    
    ุงููููุฒุงุช: ููููุฉุ ููู ููุชูุญุ ุงุณุงูุณูุฑุ ุญุฏููุฉ
    
    ุงููุงูู: ุณุงุฑุฉ ุฃุญูุฏ
    ุงูุชููููู: 01111111111
    ุงูุนููุงู: ุดุงุฑุน ุงูุชุณุนูู ุงูุดูุงูู
    
    ุชุจุน ุจูุจู
    ูุชุงุญ ูููุนุงููุฉ
    ูุชููุฑ ุตูุฑ
    """,
    """
    ูู: ูุงุทูุฉ (ููุธูุฉ ุงูุชุณููู)
    
    ๐ก ูููุง ุฏูุจููุณ ููุฅูุฌุงุฑ
    ุงูููุทูุฉ: ุงูุดุฑูู - ุงูุฏูุณ
    ุงูููุน: ูููุง ุฏูุจููุณ ูุงุถู
    ุงููุณุงุญุฉ: 250 ูุชุฑ
    ุงูุฃุฏูุงุฑ: ุฃุฑุถู + ุฃูู
    ุงูุณุนุฑ: 45000 ุฌููู ุดูุฑูุงู
    
    ุงููููุฒุงุช: ุญุฏููุฉ ุฎุงุตุฉุ ุชุดุทูุจ ุณูุจุฑ ูููุณุ ูุฏุฎู ุฎุงุต
    
    ุงููุงูู: ูุญูุฏ ุญุณู
    ุงูุชููููู: 01222222222
    ุงูุนููุงู: ุงูููุทูุฉ ุงูุซุงููุฉ
    
    ุชุจุน ููุณู ุนูุงุฏ
    ุบูุฑ ูุชุงุญ ุญุงููุงู
    ุจุฏูู ุตูุฑ
    """,
    """
    ูู: ูุญููุฏ (ูุฏูุฑ ุงููุจูุนุงุช)
    
    ๐ข ุดูุฉ ุชูููู ูููุฒุฉ
    ุงูููุทูุฉ: ุฌุงุฑุฏูููุง ูุงูุชุณ
    ุงูููุน: ุดูุฉ ููุจูุน
    ุงููุณุงุญุฉ: 180 ูุชุฑ
    ุงูุฏูุฑ: ุงูุฑุงุจุน
    ุงูุณุนุฑ: 1500000 ุฌููู
    
    ุงููููุฒุงุช: ูุณุฌูุฉ ุดูุฑ ุนูุงุฑูุ ุงุณุงูุณูุฑุ ููู ุฌุงุฑุฏูุ ุชูุณูุท
    
    ุงููุงูู: ุฃููุฑุฉ ุฎุงูุฏ
    ุงูุชููููู: 01333444555
    ุงูุนููุงู: ููุจููุฏ ุฌุงุฑุฏูููุง ูุงูุชุณ
    
    ุชุจุน ูุญููุฏ ุณุงูู
    ูุชุงุญ ูููุนุงููุฉ
    ูุชููุฑ ุตูุฑ
    """
]

async def send_employee_message(session, message, employee_num):
    """ุฅุฑุณุงู ุฑุณุงูุฉ ููุธู ูุงุญุฏ ููููุงุฉ ุงูุฑุฆูุณูุฉ"""
    
    url = f"https://api.telegram.org/bot{SENDER_BOT_TOKEN}/sendMessage"
    data = {
        "chat_id": MAIN_CHANNEL_ID,
        "text": message,
        "parse_mode": "HTML"
    }
    
    try:
        async with session.post(url, json=data) as response:
            if response.status == 200:
                result = await response.json()
                if result.get("ok"):
                    logger.info(f"โ ุชู ุชุญููู ุฑุณุงูุฉ ุงูููุธู {employee_num} ููููุงุฉ ุงูุฑุฆูุณูุฉ")
                    return True
                else:
                    logger.error(f"โ ุฎุทุฃ ูู ุชุญููู ุฑุณุงูุฉ ุงูููุธู {employee_num}: {result.get('description')}")
            else:
                logger.error(f"โ ุฎุทุฃ HTTP {response.status} ูู ุฑุณุงูุฉ ุงูููุธู {employee_num}")
                
    except Exception as e:
        logger.error(f"โ ุฎุทุฃ ูู ุฅุฑุณุงู ุฑุณุงูุฉ ุงูููุธู {employee_num}: {e}")
    
    return False

async def simulate_sender_bot():
    """ูุญุงูุงุฉ ุนูู ุงูุจูุช ุงูููุฑุณูู"""
    
    logger.info("๐ค ุจุฏุก ูุญุงูุงุฉ ุนูู ุงูุจูุช ุงูููุฑุณูู...")
    logger.info(f"๐ฑ ุงูุจูุช: @RealEstate_Sender_bot")
    logger.info(f"๐ข ุงูููุงุฉ ุงูุฑุฆูุณูุฉ: {MAIN_CHANNEL_ID}")
    logger.info("๐ ุชุญููู ุฑุณุงุฆู ุงูุฒููุงุก ููููุงุฉ...")
    logger.info("=" * 50)
    
    async with aiohttp.ClientSession() as session:
        sent_count = 0
        
        for i, message in enumerate(EMPLOYEE_MESSAGES, 1):
            logger.info(f"๐ค ุชุญููู ุฑุณุงูุฉ ูู ููุธู {i}/{len(EMPLOYEE_MESSAGES)}...")
            
            success = await send_employee_message(session, message, i)
            if success:
                sent_count += 1
            
            # ุชููู ุจูู ุงูุฑุณุงุฆู
            await asyncio.sleep(3)
        
        logger.info("=" * 50)
        logger.info(f"โ ุชู ุชุญููู {sent_count}/{len(EMPLOYEE_MESSAGES)} ุฑุณุงูุฉ ููููุงุฉ ุงูุฑุฆูุณูุฉ")
        
        if sent_count > 0:
            logger.info("๐ฏ ุงูุฑุณุงุฆู ุงูุขู ูู ุงูููุงุฉ ุงูุฑุฆูุณูุฉ ุฌุงูุฒุฉ ูููุนุงูุฌุฉ")
            logger.info("๐ ูููู ุชุดุบูู ุงููุธุงู ุงูุขู ููุนุงูุฌุฉ ูุฐู ุงูุฑุณุงุฆู")

async def main():
    """ุงูุฏุงูุฉ ุงูุฑุฆูุณูุฉ"""
    print("๐ค ูุญุงูู ุงูุจูุช ุงูููุฑุณูู")
    print("๐ฑ @RealEstate_Sender_bot")
    print("๐ ุชุญููู ุฑุณุงุฆู ุงูุฒููุงุก ููููุงุฉ ุงูุฑุฆูุณูุฉ")
    print("=" * 50)
    
    await simulate_sender_bot()
    
    print("\nโ ุงูุชูุช ุงููุญุงูุงุฉ!")
    print("๐ก ุงูุขู ูููู ุชุดุบูู ุงููุธุงู ุงูุฑุฆูุณู ููุนุงูุฌุฉ ุงูุฑุณุงุฆู")

if __name__ == "__main__":
    asyncio.run(main())
